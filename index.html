<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì‚¬ë‹¤ë¦¬ ë¸”ëŸ­ ì˜ˆì¸¡ ê²°ê³¼</title>
  <style>
    body { font-family: "Noto Sans KR", sans-serif; background: #f4f7ff; padding: 2rem; }
    h1 { font-size: 1.8rem; text-align: center; margin-bottom: 2rem; }
    .box {
      background: #fff; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 800px; margin: 2rem auto; padding: 1.5rem;
    }
    h2 { font-size: 1.4rem; margin-bottom: 1rem; color: #333; }
    ul, ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    li { margin-bottom: 0.5rem; }
    p { margin: 0.4rem 0; }
    .highlight { font-weight: bold; color: #003366; }
  </style>
</head>
<body>
  <h1>ğŸ”® ì‚¬ë‹¤ë¦¬ ë¸”ëŸ­ ì˜ˆì¸¡ ê²°ê³¼</h1>

  <section class="box">
    <h2>ğŸ“‚ í˜„ì¬ êµ¬ì¡° ê¸°ë°˜ ì˜ˆì¸¡</h2>
    <p>ì˜ˆì¸¡ íšŒì°¨: <span id="round-num"></span></p>
    <p>ê¸°ì¤€ ë¸”ëŸ­: <span id="recent-block"></span></p>
    <p>ğŸ”º ìƒë‹¨ ì˜ˆì¸¡ Top3</p>
    <ul id="top-predictions"></ul>
    <p>ğŸ”» í•˜ë‹¨ ì˜ˆì¸¡ Top3</p>
    <ul id="bottom-predictions"></ul>
  </section>

  <section class="box">
    <h2>â© ë¯¸ë˜ íë¦„ ê¸°ë°˜ ì˜ˆì¸¡</h2>
    <p>ê¸°ì¤€ ë¸”ëŸ­: <span id="forward-block"></span></p>
    <p>ğŸ“ˆ ì´í›„ ìì£¼ ë‚˜ì˜¨ Top3 ê°’:</p>
    <ol id="forward-top3"></ol>
  </section>

  <section class="box">
    <h2>ğŸ“Š ì „ì²´ ë¹ˆë„ ê¸°ë°˜ ìƒë‹¨ ì˜ˆì¸¡</h2>
    <ul id="global-top3"></ul>
  </section>

  <script>
    async function loadCombinedPrediction() {
      try {
        const res1 = await fetch("/predict?mode=3block_orig");
        const data1 = await res1.json();

        document.getElementById("round-num").textContent = data1["ì˜ˆì¸¡íšŒì°¨"];
        document.getElementById("recent-block").textContent = data1["ìƒë‹¨ê°’ë“¤"]?.[0]?.["ë¸”ëŸ­"] || "-";

        const topList = document.getElementById("top-predictions");
        const bottomList = document.getElementById("bottom-predictions");

        data1["ìƒë‹¨ê°’ë“¤"].slice(0, 3).forEach(v => {
          const li = document.createElement("li");
          li.textContent = `${v["ê°’"]} (ìˆœë²ˆ: ${v["ìˆœë²ˆ"]})`;
          topList.appendChild(li);
        });

        data1["í•˜ë‹¨ê°’ë“¤"].slice(0, 3).forEach(v => {
          const li = document.createElement("li");
          li.textContent = `${v["ê°’"]} (ìˆœë²ˆ: ${v["ìˆœë²ˆ"]})`;
          bottomList.appendChild(li);
        });

        const res2 = await fetch("/predict_forward?size=3");
        const data2 = await res2.json();

        document.getElementById("forward-block").textContent = data2["ê¸°ì¤€ë¸”ëŸ­"] || "-";
        const forwardList = document.getElementById("forward-top3");
        (data2["Top3í›„ì†ê°’"] || []).forEach(val => {
          const li = document.createElement("li");
          li.textContent = `${val} (ì¶œí˜„: ${data2["ë¹ˆë„"][val] || 0}íšŒ)`;
          forwardList.appendChild(li);
        });

        const res3 = await fetch("/predict_global_top");
        const data3 = await res3.json();

        const globalList = document.getElementById("global-top3");
        (data3["Top3"] || []).forEach(val => {
          const li = document.createElement("li");
          li.textContent = `${val} (ì¶œí˜„: ${data3["ë¹ˆë„"][val] || 0}íšŒ)`;
          globalList.appendChild(li);
        });

      } catch (e) {
        console.error("ì˜ˆì¸¡ ë¡œë”© ì‹¤íŒ¨", e);
      }
    }

    loadCombinedPrediction();
  </script>
</body>
</html>
